<!--pages/task/task.wxml-->
<wxs src="../../utils/filter.wxs" module="filter" />
<view class='task-warp'>
  <view>
      <view class='task-find box-shadow' wx:if="{{finds.length>0}}">
        <view class='task-find-title fs30'>
            <text>找料任务</text>
        </view>
        <view class='task-find-list fs30' wx:for='{{finds}}' wx:key='this'>
            <view class='task-find-item'>
               <view>物料品类：{{item.cname}}   <text class='flr'>金额:￥{{filter.formatMoney(item.form_data.fee)}}</text></view>
               <view>物料描述：{{item.form_data.desc}}</view>
               <view wx:if='{{item.form_data.find_type==1}}'>提供找料方式：按图照料</view>
               <view wx:if='{{item.form_data.find_type==2}}'>提供找料方式：按样照料</view>
               <view wx:if='{{item.form_data.find_type==3}}'>提供找料方式：按描述照料</view>
               <image class='task-find-img'
                src='../../public/images/task/task_find.png'></image>
            </view> 
            <view class='task-find-method'>
              <view class='task-find-method-img' wx:if='{{item.form_data.find_type==1}}'>
                  <image wx:if='{{item.form_data.front_img}}' 
                   catchtap="imgYu" data-src='{{item.form_data.front_img}}' src='{{item.form_data.front_img}}'></image>
                  <image wx:if='{{item.form_data.side_img}}' 
                   catchtap="imgYu" data-src='{{item.form_data.side_img}}' src='{{item.form_data.side_img}}'></image>
                  <image wx:if='{{item.form_data.back_img}}' 
                   catchtap="imgYu" data-src='{{item.form_data.back_img}}' src='{{item.form_data.back_img}}'></image>
              </view> 
              <view class='task-find-method-getfind' wx:if='{{item.form_data.find_type==2}}'>
                  <view wx:if='{{item.address.stall}}'>档  口  ：{{item.address.stall}} </view>
                  <view wx:if='{{item.address.consignee}}'>联 系 人：{{item.address.consignee}} {{item.address.mobile}}</view>
                  <view>取料地址：{{item.address.city_str}} {{item.address.address}}</view>
              </view> 
            </view> 
        </view>
        <view class='task-find-sum lh90 fs30 bb-1'>
            <text>共{{finds.length}}个任务,小计：<text class='text-red'>￥{{filter.formatMoney(findsTotalPrice)}}</text></text>
        </view> 

        <!--收货地址  -->
      <view class="fs30 bottom-border" wx:if="{{finds.length>0}}">
          <view class="cell-padding fs30 mgt-30 lh90 bottom-border">
              送料地址（找料任务）
              <input class="hidden" value="{{findsAddress.id}}" name="address_id"></input>
          </view>
          <view class="cell-padding address flex flex-start">
              <text class="iconfont icon-dizhi fs40 text-gray mgr-20"></text>

              <view data-index='1' bindtap='goConsigneeAddress' hidden='{{!findsAddress}}'  class="flex-1 address-info fs30 pdt-30">
                  <view class="flex">
                      <text>档口名称: {{findsAddress.stall}}</text>
                  </view>
                  <view class="flex">
                      <text>联系人<text class='mgl-30'>:</text> {{findsAddress.consignee}}</text>
                      <text>{{findsAddress.mobile}}</text>
                  </view>
                  <view class='pdb-30'>
                      <text>收货地址：</text>
                      <text>{{findsAddress.city_str}} {{findsAddress.address}}</text>
                  </view>
              </view>
              <view data-index='1' bindtap='goConsigneeAddress'  hidden='{{findsAddress}}' class="text-666 h100 lh100 flex-1">
                  点击添加收货地址
              </view>
          </view>
      </view>
      </view>
      
       




      <view class='task-get box-shadow' wx:if='{{fetchs.length>0}}'>
         <view class='task-find-title fs30'>
            <text>取料任务</text>
        </view>
        <view class='task-find-list fs30' wx:for='{{fetchs}}' wx:key='this'>
            <view class='task-find-item'>
               <view>物料品类：{{item.cname}}  <text class='flr pdr-30'>金额:￥{{filter.formatMoney(item.form_data.fee)}}</text></view>
               <view>物料描述：{{item.form_data.desc}}</view>
               <image class='task-find-img' src='../../public/images/task/task_get.png'></image>
            </view> 
            <view class='task-find-method'>
              <view class='task-find-method-getfind fs30'>
                  <view>档口名称：{{fetchsAddress.stall}}</view>
                  <view>联系人：{{fetchsAddress.consignee}} </view>
                  <view>取料地址：{{fetchsAddress.city_str}} {{fetchsAddress.address}}</view>
              </view> 
            </view> 
        </view>
        <view class='task-find-sum lh90 fs30 bb-1'>
            共{{fetchs.length}}个任务,小计：<text class='text-red'>￥{{filter.formatMoney(fetchsTotalPrice)}}</text>   
        </view> 
        <!--收货地址  -->
      <view class="fs30 bottom-border" wx:if='{{fetchs.length>0}}'>
          <view class="cell-padding fs30 mgt-30 lh90 bottom-border">
              送料地址（取料任务）
              <input class="hidden" value="{{fetchsAddress.id}}" name="address_id"></input>
          </view>
          <view class="cell-padding address flex flex-start">
              <text class="iconfont icon-dizhi fs40 text-gray mgr-20"></text>

              <view data-index='2' bindtap='goConsigneeAddress' hidden='{{!fetchsAddress}}'  class="flex-1 address-info fs30 pdt-30">
                  <view class="flex">
                      <text>档口名称: {{fetchsAddress.stall}}</text>
                  </view>
                  <view class="flex">
                      <text>联系人<text class='mgl-30'>:</text> {{fetchsAddress.consignee}}</text>
                      <text>{{fetchsAddress.mobile}}</text>
                  </view>
                  <view class='pdb-30'>
                      <text>收货地址：</text>
                      <text>{{fetchsAddress.city_str}} {{fetchsAddress.address}}</text>
                  </view>
              </view>
              <view data-index='2' bindtap='goConsigneeAddress'  hidden='{{fetchsAddress}}' class="text-666 h100 lh100 flex-1">
                  点击添加收货地址
              </view>
          </view>
      </view>
      </view>

      
  </view> 
  <view style='height:140rpx;'></view>
  <view class='task-pay fs30 lh120 box-shadow pdl-30' wx:if='{{fetchs.length>0 ||finds.length>0}}'>
      <view class='flr task-paybtn' style='margin-right:240rpx;'>
        应付款：<text class='text-red'>￥{{filter.formatMoney(findsTotalPrice + fetchsTotalPrice)}}</text>
      </view>
      <view class='task-sum'>
        <text style='color:#999;'>（余额:￥{{filter.formatMoney(balance_amount)}}）</text>
      </view>
      <text class='task-pay-btn text-underline' bindtap='doPay'>支付</text> 
  </view>
</view>
